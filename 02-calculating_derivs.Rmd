# Calculating derivatives

## Exercise 1

### What would happen if we extend the central-difference to also use $f(x - 2h)$ and $f(x + 2h)$? Hint: consider the Taylor series up to a sufficiently high power of $h$. Hint: "five-point stencil".

First we deduce the five point stencil rule by Taylor expansion
$$f(x \pm h) = f(x) \pm h f'(x) + \frac{h^2}{2!} f''(x) \pm \frac{h^3}{3!} f'''(x) + O(h^4)$$

$$f(x+h) - f(x-h) = 2 h f'(x) + \frac{h^3}{3} f'''(x) O(h^4)$$
$$ f(x+2h) - f(x-2h) = 4h f'(x) + \frac{8 h^3}{3} f'''(x) + O(h^4)$$
To get rid of the third term we write
$$8f(x+h) - 8f(x-h) - f(x+2h)+f(x-2h) = 12 h f'(x) + O(h^4)$$
Thus we have
$$f'(x) = 8 f(x+h) - 8f(x-h) - f(x+2h) - f(x+2h) + f(x-2h)}{12h}$$
where our truncation error is $O(h^4)$, which all else equal is better than for both forward and central differencing. 
These are $O(h)$ and $O(h^2)$ respectively.

### Analyse this method in comparison with FD and CD (theoretically and practically on specific examples)

### What are the advantages and disadvantages of the different finite difference methods?
When we use more point to calculate the derivative we get a smaller truncation error thus allowing us to use a smaller value for $h$.
The disadvantage is that the function needs to be evaluated in more points which could be expensive.
Therefore the choice of method depends on the specific problem.

## Exercise 2


## Exercise 3


\newpage